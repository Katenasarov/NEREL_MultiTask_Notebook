# Проект «Многоцелевая модель для NER и классификации». 

***Суть проекта:***

Проект направлен на создание единой, многоцелевой (multi-task) нейронной сети для решения двух задач на основе одного и того же входного текста:

- Распознавание именованных сущностей (NER): Извлечение из текста конкретных объектов, таких как имена людей (PERSON), названия организаций (ORGANIZATION), даты (DATE), места (CITY, COUNTRY) и т.д. Это задача на уровне отдельных токенов (слов или их частей).
  
- Классификация событий/отношений (CLS): Определение более глобальных, семантических признаков всего документа, таких как типы событий (например, убийство, арест, встреча) или отношений между сущностями (например, WORKS_AS, LOCATED_IN). Это задача на уровне всего документа, результатом которой является вектор (multihot), указывающий, какие из предопределенных событий/отношений присутствуют в тексте.

***Цели проекта:***

Повышение эффективности: Заменить текущий раздельный пайплайн (две отдельные модели для NER и CLS) на одну совместную модель. Это должно сократить дублирование признаков и снизить общие вычислительные затраты.
Проверка гипотезы: Экспериментально подтвердить или опровергнуть предположение, что совместное обучение (multi-task learning) может улучшить качество распознавания сущностей (NER) и/или повысить стабильность и точность классификации событий (CLS) за счет того, что задачи "помогают" друг другу во время обучения.
Создание воспроизводимого эксперимента: Построить компактный, но полноценный прототип системы, который можно запустить и оценить.

***Задачи проекта:***

Проект разбит на конкретные технические этапы:

Анализ данных (EDA): Изучить структуру датасета NEREL, посчитать статистики по типам сущностей и событий, визуализировать данные.
Подготовка данных: Написать парсеры для извлечения сущностей и отношений из JSONL-файлов, преобразовать данные в формат, пригодный для обучения (токены, метки BIO для NER, multihot-векторы для CLS).
Построение пайплайна: Настроить токенизатор, выровнять метки NER с токенами модели, создать загрузчики данных (DataLoader).
Реализация модели: Создать архитектуру JointModel, которая на основе энкодера (например, RuBERT) выдает два набора предсказаний: для NER и для CLS.
Реализация функции потерь: Написать кастомную функцию потерь, которая объединяет потери от обеих задач, возможно, с использованием продвинутой техники взвешивания (uncertainty weighting) для автоматического баланса между задачами.
Обучение и оценка: Обучить модель, отслеживать метрики (F1 для NER, F1 для CLS) на валидационной выборке, оценить финальное качество на тестовой выборке.
Анализ результатов: Провести качественный анализ предсказаний модели на примерах, проверить влияние совместного обучения, возможно, протестировать квантизированную версию модели.

***Для эксперемента использован датасет NEREL:***

Датасет NEREL — это коллекция новостных текстов на русском языке, размеченных для решения задач NER и Relation Extraction (которая в рамках этого проекта интерпретируется как классификация событий на уровне документа).

wget -O train.jsonl "https://huggingface.co/datasets/iluvvatar/NEREL/resolve/main/data/train.jsonl"
wget -O dev.jsonl   "https://huggingface.co/datasets/iluvvatar/NEREL/resolve/main/data/dev.jsonl"
wget -O test.jsonl  "https://huggingface.co/datasets/iluvvatar/NEREL/resolve/main/data/test.jsonl"

wget -O ent_types.jsonl"https://huggingface.co/datasets/iluvvatar/NEREL/resolve/main/ent_types.jsonl"
wget -O rel_types.jsonl "https://huggingface.co/datasets/iluvvatar/NEREL/resolve/main/rel_types.jsonl" 

Формат: Данные представлены в формате JSONL, где каждая строка — это отдельный документ (новость).

Содержимое документа:
text: Сам текст новости.
entities: Список именованных сущностей. Каждая сущность представлена строкой с типом, начальным и конечным индексами в тексте и самим упоминанием (например, T1\tPERSON 0 5\tГоблин).
relations: Список отношений между сущностями. Каждое отношение связывает две сущности по их идентификаторам и имеет тип (например, R1\tWORKS_AS Arg1:T5 Arg2:T37).

Дополнительные файлы:

ent_types.jsonl: Содержит список всех возможных типов именованных сущностей (например, PERSON, ORGANIZATION, DATE).
rel_types.jsonl: Содержит список всех возможных типов отношений (например, WORKS_AS, LOCATED_IN, AGENT).

В этом проекте отношения (relations) используются не для классической задачи извлечения отношений (предсказание связи между двумя конкретными сущностями), а для формирования документ-уровневой классификации. То есть, если в тексте есть хотя бы одно отношение типа WORKS_AS, то для этого документа в multihot-векторе CLS соответствующий бит будет установлен в 1, сигнализируя о том, что в тексте присутствует информация о трудоустройстве.